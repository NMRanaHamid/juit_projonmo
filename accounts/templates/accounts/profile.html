{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="max-w-3xl mx-auto bg-white p-8 mt-12 rounded-2xl shadow-lg">

  <!-- Header -->
  <div class="text-center">
    {% if profile.avatar and profile.avatar.name %}
      <img src="{{ profile.avatar.url }}" alt="{{ profile.user.username }}" class="w-40 h-40 rounded-full mx-auto object-cover shadow-lg">
    {% else %}
      <img src="{% static 'image/default_avatar.jpg' %}" alt="Default avatar" class="w-40 h-40 rounded-full mx-auto object-cover shadow-lg">
    {% endif %}

    <h2 class="text-3xl font-bold text-gray-800">{{ profile.user.username }}</h2>
    <p class="text-gray-500">{{ profile.user.email }}</p>
  </div>

  <!-- Info Card -->
  <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6 text-left">
    <div class="p-4 bg-gray-50 rounded-xl shadow-sm">
      <p class="text-sm text-gray-500">First Name</p>
      <p class="font-medium text-gray-800">{{ profile.user.first_name|default:"Not set" }}</p>
    </div>
    <div class="p-4 bg-gray-50 rounded-xl shadow-sm">
      <p class="text-sm text-gray-500">Last Name</p>
      <p class="font-medium text-gray-800">{{ profile.user.last_name|default:"Not set" }}</p>
    </div>
    <div class="p-4 bg-gray-50 rounded-xl shadow-sm">
      {% if profile.batch %}
        {% if profile.batch|lower == "teacher" or profile.batch|lower == "staff" or profile.batch|lower == "lab assistant" %}
          <p class="text-sm text-gray-500">Designation</p>
          <p class="font-medium text-gray-800">{{ profile.batch }}</p>
        {% else %}
          <p class="text-sm text-gray-500">Batch</p>
          <p class="font-medium text-gray-800">{{ profile.batch }}</p>
        {% endif %}
      {% else %}
        <p class="text-sm text-gray-500">Batch</p>
        <p class="font-medium text-gray-800">Not set</p>
      {% endif %}
    </div>
    <div class="p-4 bg-gray-50 rounded-xl shadow-sm md:col-span-2">
      <p class="text-sm text-gray-500">Bio</p>
      <p class="font-medium text-gray-800">{{ profile.bio|default:"No bio" }}</p>
    </div>
  </div>

  <!-- Social Links -->
  <div class="mt-8 text-center">
    <h3 class="text-lg font-semibold text-gray-700 mb-4">Social Profiles</h3>
    <div class="flex justify-center space-x-4">
      {% if profile.linkedin %}
        <a href="{{ profile.linkedin }}" target="_blank"
           class="bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition">
          LinkedIn
        </a>
      {% else %}
        <span class="px-4 py-2 rounded-lg bg-gray-200 text-gray-500">No LinkedIn</span>
      {% endif %}

      {% if profile.facebook %}
        <a href="{{ profile.facebook }}" target="_blank"
           class="bg-blue-700 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-800 transition">
          Facebook
        </a>
      {% else %}
        <span class="px-4 py-2 rounded-lg bg-gray-200 text-gray-500">No Facebook</span>
      {% endif %}
    </div>
  </div>

  <!-- Actions -->
  <div class="mt-10 flex flex-wrap justify-center gap-4">
    <a href="{% url 'accounts:edit_profile' %}"
       class="bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 transition">
      Edit Profile
    </a>
    <a href="{% url 'accounts:change_password' %}"
       class="bg-yellow-500 text-white px-6 py-2 rounded-lg font-medium hover:bg-yellow-600 transition">
      Change Password
    </a>
    <a href="{% url 'accounts:delete_account' %}"
       class="bg-red-600 text-white px-6 py-2 rounded-lg font-bold hover:bg-red-700 transition">
      Delete Account
    </a>
  </div>

</div>

<!-- New Section: User's Posts and Jobs -->
<div class="max-w-3xl mx-auto bg-white p-8 mt-8 rounded-2xl shadow-lg">

  <h3 class="text-2xl font-bold text-gray-800 mb-6">User Contributions</h3>

  <!-- User Posts -->
  <div class="mb-8">
    <h4 class="text-xl font-semibold text-blue-700 mb-4">Posts</h4>
    {% if posts %}
      <ul class="space-y-3">
        {% for post in posts %}
          <li class="p-4 bg-gray-50 rounded-lg shadow hover:shadow-md transition">
            <a href="{% url 'posts:post_detail' post.pk %}" class="text-lg font-medium text-gray-800 hover:text-blue-600">
              {{ post.title }}
            </a>
            <p class="text-sm text-gray-500">Published on {{ post.created_at|date:"F j, Y" }}</p>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-gray-500">No posts created yet.</p>
    {% endif %}
  </div>

  <!-- User Jobs -->
  <div>
    <h4 class="text-xl font-semibold text-blue-700 mb-4">Jobs</h4>
    {% if jobs %}
      <ul class="space-y-3">
        {% for job in jobs %}
          <li class="p-4 bg-gray-50 rounded-lg shadow hover:shadow-md transition">
            <a href="{% url 'jobs:job_detail' job.pk %}" class="text-lg font-medium text-gray-800 hover:text-blue-600">
              {{ job.title }}
            </a>
            <p class="text-sm text-gray-500">Posted on {{ job.posted_at|date:"F j, Y" }}</p>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-gray-500">No jobs posted yet.</p>
    {% endif %}
  </div>

</div>
{% endblock %}
